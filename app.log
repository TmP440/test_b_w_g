DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Не удалось подключиться к продюсеру: Please create objects with the same loop as running with
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: Task <Task pending name='Task-1' coro=<run_tasks() running at /home/eugene/Документы/exp/exp/main.py:21> cb=[_run_until_complete_cb() at /usr/lib/python3.10/asyncio/base_events.py:184]> got Future <Future pending cb=[shield.<locals>._outer_done_callback() at /usr/lib/python3.10/asyncio/tasks.py:864]> attached to a different loop
ERROR:aiomultiprocess.core:aio process 93082 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed AIOKafkaProducer
producer: <aiokafka.producer.producer.AIOKafkaProducer object at 0x7f6fbd2d63e0>
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6fbd2f8b20>
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Не удалось подключиться к продюсеру: Please create objects with the same loop as running with
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: Task <Task pending name='Task-1' coro=<run_tasks() running at /home/eugene/Документы/exp/exp/main.py:21> cb=[_run_until_complete_cb() at /usr/lib/python3.10/asyncio/base_events.py:184]> got Future <Future pending cb=[shield.<locals>._outer_done_callback() at /usr/lib/python3.10/asyncio/tasks.py:864]> attached to a different loop
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: Task <Task pending name='Task-1' coro=<run_tasks() running at /home/eugene/Документы/exp/exp/main.py:21> cb=[_run_until_complete_cb() at /usr/lib/python3.10/asyncio/base_events.py:184]> got Future <Future pending cb=[shield.<locals>._outer_done_callback() at /usr/lib/python3.10/asyncio/tasks.py:864]> attached to a different loop
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: Task <Task pending name='Task-1' coro=<run_tasks() running at /home/eugene/Документы/exp/exp/main.py:21> cb=[_run_until_complete_cb() at /usr/lib/python3.10/asyncio/base_events.py:184]> got Future <Future pending cb=[shield.<locals>._outer_done_callback() at /usr/lib/python3.10/asyncio/tasks.py:864]> attached to a different loop
ERROR:aiomultiprocess.core:aio process 94546 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed AIOKafkaProducer
producer: <aiokafka.producer.producer.AIOKafkaProducer object at 0x7f427e3e7a30>
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f427e408c10>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 102901 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fce9f20c190>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fce9f57c160>, 20581.243299535)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fce9f20c3a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 106213 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f9e31b18250>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f9e31dd4280>, 20981.848177819)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f9e31b18460>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 107238 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fef85e0c1f0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fef861d0160>, 21392.652793318)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fef85e0c340>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 108486 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc915b68160>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fc9159fc340>, 21414.547881013)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fc915b682b0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:aiomultiprocess.core:aio process 109570 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f060a2d43d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 109869 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fbedab101c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fbedadd8220>, 21722.690980834)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fbedab10310>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 110080 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f059addc100>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 111309 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f86af60c1c0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 111501 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fab65e38190>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fab660f81c0>, 22004.856677107)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fab65e382e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 113288 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f7e0de0c190>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f7e0e0c8280>, 23391.941021258)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f7e0de0c2e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 118176 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f20596001f0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f20598cc220>, 23629.975971921)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f2059600400>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: float() argument must be a string or a real number, not 'dict'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 119472 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f848f00c400>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f848f3d0160>, 25776.192710374)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f848f00c610>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(data):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 129188 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fddc680c520>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fddc6b78160>, 25802.777252549)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fddc680c670>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 129633 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f35ea0fc040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f35ea0c8100>, 25867.522109152)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f35ea0fc730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 129813 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4f4f3104f0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 130298 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb46e814040>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 130473 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fa51b1e0100>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fa51b0dc340>, 26123.077593203)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fa51b1e0850>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 131194 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f99f99244f0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f99f9bf0220>, 26131.067474958)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f99f9924700>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 131257 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f27e2bc8520>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 131537 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f81a700c040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f81a72dc2e0>, 26206.351528301)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f81a700c730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 132188 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f9ceea0c040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f9ceecd8340>, 26341.259021361)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f9ceea0c730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 136228 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6348010520>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f63482d4220>, 27309.196936652)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6348010670>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 142898 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7efdbd4dc4c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7efdbd5003a0>, 28975.32448237)]']
connector: <aiohttp.connector.TCPConnector object at 0x7efdbd4dc6d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 143426 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fbeb7b104c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fbeb7dd01c0>, 29034.069363233)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fbeb7b106d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 144039 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f2c76e98040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f2c76ffc3a0>, 29203.632264387)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f2c76e98790>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 144627 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f541bee04c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f541bddcac0>, 29309.259292269)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f541bee06d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 144697 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f586f114040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f586f3e02e0>, 29321.671539869)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f586f114730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def save_to_db(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 145206 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f12296080a0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f12298d81c0>, 29392.784776018)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f12296087f0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def save_to_db(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 145569 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0f427fc550>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def save_to_db(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 146230 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f61089d4580>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 146858 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4ddb898040>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f4ddb9fc2e0>, 29704.421367767)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f4ddb898730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 148585 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6c64ef7520>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f6c6506c460>, 29977.385216069)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6c64ef7c70>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 148916 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ffa35df3400>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7ffa35f60400>, 30027.782001934)]']
connector: <aiohttp.connector.TCPConnector object at 0x7ffa35df3b50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 149427 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc6679fb4c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fc667b743a0>, 30127.055930486)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fc6679fbc10>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 149655 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fad9de94070>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fad9dfe0220>, 30146.279438645)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fad9de94760>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 150630 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fea086566e0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fea08413f40>, 30345.885519601)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fea08656e30>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 151426 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f55f89866b0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f55f873ff40>, 30489.148435392)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f55f8986e00>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc165e4a620>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 152054 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f3b844925f0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f3b8424fe80>, 30599.218646933)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f3b84492d40>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 152108 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f82a9a52680>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f82a980bf40>, 30617.302574804)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f82a9a52dd0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 152265 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f73d68926b0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 152518 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/exp/exp/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/exp/exp/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7eff100044c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7eff102cc220>, 30700.199160084)]']
connector: <aiohttp.connector.TCPConnector object at 0x7eff100046d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 346985 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7feb9d0fdfc0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7feb9d0e4a00>, 352996.420071861)]']
connector: <aiohttp.connector.TCPConnector object at 0x7feb9d0fdf60>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 347194 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f9a3d792860>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f9a3c45fbe0>, 353086.034116597)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f9a3d793010>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

ERROR:aiomultiprocess.core:aio process 347397 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f52a2d11b40>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 347490 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc52912d540>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fc5291395a0>, 353168.68581004)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fc52912d750>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 347571 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4ee9529ba0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:celery.utils.functional:
def process_message(pair, price):
    return 1

DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 348002 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc7d09288b0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fc7d0a3dd80>, 353545.433757458)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fc7d0928910>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 10193 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f550b3f8490>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 10244 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f76635d4490>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 16877 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f66aa3fc4f0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 16943 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f3e642f4490>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fdeffde44c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fdeffdaf760>, 3844.182574779)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fdeffde4580>
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 16986 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4065dd03d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f4065d962c0>, 3900.781343861)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f4065dd0490>
ERROR:aiomultiprocess.core:aio process 17022 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7effee4f43d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7effee4b6440>, 3921.78510132)]']
connector: <aiohttp.connector.TCPConnector object at 0x7effee4f4490>
ERROR:aiomultiprocess.core:aio process 17064 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 17098 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f5b001c8400>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb10e7e4490>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fb10e7ae380>, 4028.913712558)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fb10e7e4550>
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 17157 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4377ed43d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f4377e96200>, 4125.558712191)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f4377ed4490>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 17253 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка в основном цикле: nats: mixing of websocket and non websocket URLs is not allowed
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fad960fc4f0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fad960c22c0>, 4633.468632066)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fad960fc5b0>
ERROR:aiomultiprocess.core:aio process 18352 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 18391 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f1f9d5e83a0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f1f9d5b2260>, 4683.532192518)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f1f9d5e8460>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 18460 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fd81ced83a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 19810 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff9a3bcc580>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 19940 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fa1335d04c0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 20014 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fa598be8520>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 20167 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff0471b4190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 20257 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb7de1281c0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 20339 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f47f9148190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00041s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.015s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:aiomultiprocess.core:aio process 20692 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f538e3809a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00031s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.193s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 2.102s ago] ('ETHUSDT',)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 20848 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0edf2b89a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00011s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 0.9005s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 21083 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0d65c78190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00010s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 21151 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff364980190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 21211 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f79f3234a30>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[generated in 0.00012s] ('BTCUSDT', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[cached since 0.8165s ago] ('BTCRUB', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 21249 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff66161c190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[generated in 0.00064s] ('BTCUSDT', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[cached since 0.7564s ago] ('BTCRUB', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[cached since 1.585s ago] ('ETHUSDT', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
 FETCH FIRST ($2::INTEGER) ROWS ONLY
INFO:sqlalchemy.engine.Engine:[cached since 2.404s ago] ('ETHRUB', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 21303 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f8ec2a58970>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00011s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.523s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:aiomultiprocess.core:aio process 21497 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f1cce7eca30>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:INSERT INTO pairs (symbol, price) VALUES ($1::VARCHAR, $2::FLOAT(5))
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] ('BTCUSDT', '"42983.91108313"')
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.728s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:INSERT INTO pairs (symbol, price) VALUES ($1::VARCHAR, $2::FLOAT(5))
INFO:sqlalchemy.engine.Engine:[cached since 1.733s ago] ('BTCRUB', '"3900027.00000000"')
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:aiomultiprocess.core:aio process 21574 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f29aa464160>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00028s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.099s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:aiomultiprocess.core:aio process 21623 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f152a264a30>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/subscription.py", line 316, in _wait_for_msgs
    await self._cb(msg)
  File "/home/eugene/Документы/test_b_w_g/kafka_server/tasks/save_db.py", line 40, in message_handler
    print(data_dict["price"], type(data_dict["price"]), type(float(data_dict["price"])))
ValueError: could not convert string to float: '"43004.33772590"'
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/subscription.py", line 316, in _wait_for_msgs
    await self._cb(msg)
  File "/home/eugene/Документы/test_b_w_g/kafka_server/tasks/save_db.py", line 40, in message_handler
    print(data_dict["price"], type(data_dict["price"]), type(float(data_dict["price"])))
ValueError: could not convert string to float: '"3900027.00000000"'
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/subscription.py", line 316, in _wait_for_msgs
    await self._cb(msg)
  File "/home/eugene/Документы/test_b_w_g/kafka_server/tasks/save_db.py", line 40, in message_handler
    print(data_dict["price"], type(data_dict["price"]), type(float(data_dict["price"])))
ValueError: could not convert string to float: '"2308.87960104"'
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/subscription.py", line 316, in _wait_for_msgs
    await self._cb(msg)
  File "/home/eugene/Документы/test_b_w_g/kafka_server/tasks/save_db.py", line 40, in message_handler
    print(data_dict["price"], type(data_dict["price"]), type(float(data_dict["price"])))
ValueError: could not convert string to float: '"181477.60000000"'
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 21721 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0cac5ec190>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f0cac5cd720>, 6828.68892743)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f0cac5ec040>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 0.323s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 0.6542s ago] ('ETHUSDT',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.651s ago] ('ETHRUB',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:aiomultiprocess.core:aio process 21786 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fa686ef8190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00031s] ('BTCUSDT',)
INFO:sqlalchemy.engine.Engine:INSERT INTO pairs (symbol, price) VALUES ($1::VARCHAR, $2::FLOAT(5))
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] ('BTCUSDT', 43018.92116182)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[cached since 1.308s ago] ('BTCRUB',)
INFO:sqlalchemy.engine.Engine:INSERT INTO pairs (symbol, price) VALUES ($1::VARCHAR, $2::FLOAT(5))
INFO:sqlalchemy.engine.Engine:[cached since 1.312s ago] ('BTCRUB', 3900027.0)
INFO:sqlalchemy.engine.Engine:COMMIT
ERROR:aiomultiprocess.core:aio process 21919 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f2af5634190>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 22046 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f84a1579c60>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f84a15a4e80>, 7174.157748536)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f84a1579de0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 22219 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb9cfc79de0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fb9cfbaa380>, 7245.06731302)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fb9cfc79f60>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 22272 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc834769d20>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 22414 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f9493541de0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f9493590f40>, 7437.470387848)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f9493541f60>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:kafka_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 22936 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 14, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f2761e75d80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: APIError(code=-1121): Invalid symbol.
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: APIError(code=-1121): Invalid symbol.
ERROR:aiomultiprocess.core:aio process 26821 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff6dca79d20>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7ff6dc995000>, 9027.70467714)]']
connector: <aiohttp.connector.TCPConnector object at 0x7ff6dca79ea0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
ERROR:aiomultiprocess.core:aio process 29710 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fca1127dd50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCCBCD: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHCBCD: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 29868 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f578f35dcc0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 30256 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f9543175c30>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
ERROR:aiomultiprocess.core:aio process 30376 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f467647dd50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 30641 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f749584dcc0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
ERROR:aiomultiprocess.core:aio process 30871 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff674629cc0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 30945 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fca1bc79d80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 31007 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f3e40569d80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 31206 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0820d61cf0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f0820c7ce80>, 12426.584835365)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f0820d61e70>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'BTCRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ETHRUB'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 31375 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f636fa85d50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 31806 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fee7f585cf0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 32378 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4dedf51d80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 32454 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb8cdbc9db0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 32527 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7efdf6a7dd80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 33431 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4759369c90>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f4759395060>, 13564.511615506)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f4759369e10>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 33462 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f26c0551c90>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 33761 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f084b779d20>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
ERROR:aiomultiprocess.core:aio process 34048 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f28b4f4dc60>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка в основном цикле: local variable 'price' referenced before assignment
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f007a559c90>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f007a585180>, 14845.528670937)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f007a559e10>
ERROR:aiomultiprocess.core:aio process 35089 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка в основном цикле: local variable 'price' referenced before assignment
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6a39459cf0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f6a3a3ac9a0>, 14870.088884304)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6a39459e70>
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 35130 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'coroutine' object is not subscriptable
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'coroutine' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 35219 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc2d9251c60>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 35282 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/uvicorn/main.py", line 582, in run
    ChangeReload(config, target=server.run, sockets=[sock]).run()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/uvicorn/supervisors/basereload.py", line 52, in run
    for changes in self:
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/uvicorn/supervisors/basereload.py", line 71, in __next__
    return self.should_restart()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/uvicorn/supervisors/statreload.py", line 34, in should_restart
    for file in self.iter_py_files():
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/uvicorn/supervisors/statreload.py", line 54, in iter_py_files
    for path in list(reload_dir.rglob("*.py")):
  File "/usr/local/lib/python3.10/pathlib.py", line 1045, in rglob
    for p in selector.select_from(self):
  File "/usr/local/lib/python3.10/pathlib.py", line 493, in _select_from
    for p in successor_select(starting_point, is_dir, exists, scandir):
  File "/usr/local/lib/python3.10/pathlib.py", line 440, in _select_from
    with scandir(parent_path) as scandir_it:
FileNotFoundError: [Errno 2] No such file or directory: '/home/eugene/Документы/test_b_w_g/binance_async'
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7faefbd51cf0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7faefbd7d000>, 16432.121761863)]']
connector: <aiohttp.connector.TCPConnector object at 0x7faefbd51e70>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2311.66
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.66
INFO:core.logs:The pair: ETHUSDT - 2311.66 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210309
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210309"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210309"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 210309
INFO:core.logs:The pair: ETHRUB - 210309.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998554
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998554"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998554"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998554
INFO:core.logs:The pair: USDTTRCUSDT - 0.998554 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998554
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998554"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998554"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998554
INFO:core.logs:The pair: USDTERCUSDT - 0.998554 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3914012
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3914012
INFO:core.logs:The pair: BTCRUB - 3914012.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 37499 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f8c0e161f90>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f8c0e1911e0>, 16529.418205452)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f8c0e162110>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43053
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43053"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43053"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43053
INFO:core.logs:The pair: BTCUSDT - 43053.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3914012
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3914012
INFO:core.logs:The pair: BTCRUB - 3914012.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2312.39
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2312.39"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2312.39"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2312.39
INFO:core.logs:The pair: ETHUSDT - 2312.39 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999011
INFO:core.logs:The pair: USDTTRCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999011
INFO:core.logs:The pair: USDTERCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43041
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43041"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43041"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43041
INFO:core.logs:The pair: BTCUSDT - 43041.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3914012
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3914012"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3914012
INFO:core.logs:The pair: BTCRUB - 3914012.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2312.39
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2312.39"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2312.39"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2312.39
INFO:core.logs:The pair: ETHUSDT - 2312.39 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999011
INFO:core.logs:The pair: USDTERCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3912843
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912843"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912843"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3912843
INFO:core.logs:The pair: BTCRUB - 3912843.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2311.46
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.46"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.46"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.46
INFO:core.logs:The pair: ETHUSDT - 2311.46 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999011
INFO:core.logs:The pair: USDTTRCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999011
INFO:core.logs:The pair: USDTERCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43038
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43038"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43038"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43038
INFO:core.logs:The pair: BTCUSDT - 43038.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3912843
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912843"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912843"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3912843
INFO:core.logs:The pair: BTCRUB - 3912843.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2311.58
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.58
INFO:core.logs:The pair: ETHUSDT - 2311.58 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999011
INFO:core.logs:The pair: USDTERCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210160
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210160"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210160
INFO:core.logs:The pair: ETHRUB - 210160.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999011
INFO:core.logs:The pair: USDTTRCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999011
INFO:core.logs:The pair: USDTERCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43041
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43041"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43041"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43041
INFO:core.logs:The pair: BTCUSDT - 43041.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3912215
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912215"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3912215"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3912215
INFO:core.logs:The pair: BTCRUB - 3912215.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2311.58
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.58
INFO:core.logs:The pair: ETHUSDT - 2311.58 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210102
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210102
INFO:core.logs:The pair: ETHRUB - 210102.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999011"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999011
INFO:core.logs:The pair: USDTTRCUSDT - 0.999011 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3909752
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3909752
INFO:core.logs:The pair: BTCRUB - 3909752.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2310.1
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.1"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.1"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2310.1
INFO:core.logs:The pair: ETHUSDT - 2310.1 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999193
INFO:core.logs:The pair: USDTTRCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999193
INFO:core.logs:The pair: USDTERCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43007
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43007
INFO:core.logs:The pair: BTCUSDT - 43007.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3909752
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3909752
INFO:core.logs:The pair: BTCRUB - 3909752.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2311.58
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.58"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.58
INFO:core.logs:The pair: ETHUSDT - 2311.58 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210102
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210102
INFO:core.logs:The pair: ETHRUB - 210102.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999193
INFO:core.logs:The pair: USDTTRCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999193
INFO:core.logs:The pair: USDTERCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43007
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43007
INFO:core.logs:The pair: BTCUSDT - 43007.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3910959
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3910959
INFO:core.logs:The pair: BTCRUB - 3910959.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2310.64
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.64"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.64"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2310.64
INFO:core.logs:The pair: ETHUSDT - 2310.64 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210102
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210102
INFO:core.logs:The pair: ETHRUB - 210102.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999193
INFO:core.logs:The pair: USDTTRCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210102
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210102
INFO:core.logs:The pair: ETHRUB - 210102.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999193
INFO:core.logs:The pair: USDTTRCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43026
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43026"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43026"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43026
INFO:core.logs:The pair: BTCUSDT - 43026.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3910959
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3910959
INFO:core.logs:The pair: BTCRUB - 3910959.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2310.64
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.64"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2310.64"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2310.64
INFO:core.logs:The pair: ETHUSDT - 2310.64 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210102
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210102"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210102
INFO:core.logs:The pair: ETHRUB - 210102.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210216
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210216"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210216"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210216
INFO:core.logs:The pair: ETHRUB - 210216.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999193
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999193"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999193
INFO:core.logs:The pair: USDTERCUSDT - 0.999193 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43007
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43007"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43007
INFO:core.logs:The pair: BTCUSDT - 43007.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3909752
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3909752"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3909752
INFO:core.logs:The pair: BTCRUB - 3909752.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 210216
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210216"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "210216"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 210216
INFO:core.logs:The pair: ETHRUB - 210216.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'trub'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43035
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43035"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43035"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43035
INFO:core.logs:The pair: BTCUSDT - 43035.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3910959
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3910959"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3910959
INFO:core.logs:The pair: BTCRUB - 3910959.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCUSDT: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для BTCRUB: 'bitcoin'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHUSDT: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для ETHRUB: 'ethereum'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'tether'
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 43036
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43036"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43036"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43036
INFO:core.logs:The pair: BTCUSDT - 43036.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3913166
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3913166"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3913166"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3913166
INFO:core.logs:The pair: BTCRUB - 3913166.0 has been updated
INFO:core.logs:db_updated
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 37613 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f0a9a881f30>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f0a9a8ad180>, 17200.705030819)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f0a9a8820b0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43075.95959615
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43075.95959615\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43075.95959615\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43075.95959615"
INFO:core.logs:The pair: BTCUSDT - 43075.95959615 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2314.14132599
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.14132599\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.14132599\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2314.14132599"
INFO:core.logs:The pair: ETHUSDT - 2314.14132599 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43080.24983032
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43080.24983032\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43080.24983032\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43080.24983032"
INFO:core.logs:The pair: BTCUSDT - 43080.24983032 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2314.22146742
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.22146742\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.22146742\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2314.22146742"
INFO:core.logs:The pair: ETHUSDT - 2314.22146742 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43081.13399249
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43081.13399249\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43081.13399249\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43081.13399249"
INFO:core.logs:The pair: BTCUSDT - 43081.13399249 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2314.33266773
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.33266773\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.33266773\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2314.33266773"
INFO:core.logs:The pair: ETHUSDT - 2314.33266773 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43083.19843037
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43083.19843037\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43083.19843037\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43083.19843037"
INFO:core.logs:The pair: BTCUSDT - 43083.19843037 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2314.41857655
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.41857655\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.41857655\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2314.41857655"
INFO:core.logs:The pair: ETHUSDT - 2314.41857655 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43084.15713257
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43084.15713257\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43084.15713257\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43084.15713257"
INFO:core.logs:The pair: BTCUSDT - 43084.15713257 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2314.44865905
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.44865905\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2314.44865905\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2314.44865905"
INFO:core.logs:The pair: ETHUSDT - 2314.44865905 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 35, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43086.55639988
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43086.55639988\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43086.55639988\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43086.55639988"
INFO:core.logs:The pair: BTCUSDT - 43086.55639988 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 38284 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f1769e2f130>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43083.63924023
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43083.63924023\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43083.63924023\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43083.63924023"
INFO:core.logs:The pair: BTCUSDT - 43083.63924023 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2313.47749103
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2313.47749103\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2313.47749103\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2313.47749103"
INFO:core.logs:The pair: ETHUSDT - 2313.47749103 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43053.33640079
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43053.33640079\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43053.33640079\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43053.33640079"
INFO:core.logs:The pair: BTCUSDT - 43053.33640079 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2312.57192509
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2312.57192509\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2312.57192509\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2312.57192509"
INFO:core.logs:The pair: ETHUSDT - 2312.57192509 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=trub HTTP/1.1" 200 None
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'trub'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'trub'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43025.25774374
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43025.25774374\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"43025.25774374\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "43025.25774374"
INFO:core.logs:The pair: BTCUSDT - 43025.25774374 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2311.30482763
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2311.30482763\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2311.30482763\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2311.30482763"
INFO:core.logs:The pair: ETHUSDT - 2311.30482763 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999541
INFO:core.logs:The pair: USDTTRCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 38386 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fe7806518a0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fe7806a0f40>, 17372.118007981)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fe780651960>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42955.65662330
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42955.65662330\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42955.65662330\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42955.65662330"
INFO:core.logs:The pair: BTCUSDT - 42955.6566233 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2307.70978602
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2307.70978602\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2307.70978602\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2307.70978602"
INFO:core.logs:The pair: ETHUSDT - 2307.70978602 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42950.65204177
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42950.65204177\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42950.65204177\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42950.65204177"
INFO:core.logs:The pair: BTCUSDT - 42950.65204177 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2307.33873965
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2307.33873965\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2307.33873965\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2307.33873965"
INFO:core.logs:The pair: ETHUSDT - 2307.33873965 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42943.09846845
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42943.09846845\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42943.09846845\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42943.09846845"
INFO:core.logs:The pair: BTCUSDT - 42943.09846845 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.74017135
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.74017135\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.74017135\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2306.74017135"
INFO:core.logs:The pair: ETHUSDT - 2306.74017135 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999541
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999541"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999541
INFO:core.logs:The pair: USDTERCUSDT - 0.999541 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42941.70580154
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42941.70580154\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42941.70580154\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42941.70580154"
INFO:core.logs:The pair: BTCUSDT - 42941.70580154 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.58820899
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.58820899\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.58820899\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2306.58820899"
INFO:core.logs:The pair: ETHUSDT - 2306.58820899 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:Added new pair: USDTTRCRUB - 90.87
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42937.39361285
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42937.39361285\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42937.39361285\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42937.39361285"
INFO:core.logs:The pair: BTCUSDT - 42937.39361285 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.33563448
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.33563448\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2306.33563448\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2306.33563448"
INFO:core.logs:The pair: ETHUSDT - 2306.33563448 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42929.82537695
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42929.82537695\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42929.82537695\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42929.82537695"
INFO:core.logs:The pair: BTCUSDT - 42929.82537695 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2305.51831528
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2305.51831528\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2305.51831528\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2305.51831528"
INFO:core.logs:The pair: ETHUSDT - 2305.51831528 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42925.88839256
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42925.88839256\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42925.88839256\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42925.88839256"
INFO:core.logs:The pair: BTCUSDT - 42925.88839256 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2305.15653384
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2305.15653384\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2305.15653384\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2305.15653384"
INFO:core.logs:The pair: ETHUSDT - 2305.15653384 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 38461 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f85c93518d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f85c93790c0>, 17517.803198993)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f85c9351990>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42863.09899721
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42863.09899721\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42863.09899721\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42863.09899721"
INFO:core.logs:The pair: BTCUSDT - 42863.09899721 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2299.96464221
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.96464221\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.96464221\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2299.96464221"
INFO:core.logs:The pair: ETHUSDT - 2299.96464221 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42861.70534408
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42861.70534408\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42861.70534408\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42861.70534408"
INFO:core.logs:The pair: BTCUSDT - 42861.70534408 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2299.85819695
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.85819695\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.85819695\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2299.85819695"
INFO:core.logs:The pair: ETHUSDT - 2299.85819695 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42866.20147623
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42866.20147623\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42866.20147623\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42866.20147623"
INFO:core.logs:The pair: BTCUSDT - 42866.20147623 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2299.84974721
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.84974721\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.84974721\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2299.84974721"
INFO:core.logs:The pair: ETHUSDT - 2299.84974721 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCUSDT: 42868.25619631
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42868.25619631\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42868.25619631\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42868.25619631"
INFO:core.logs:The pair: BTCUSDT - 42868.25619631 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2299.97218434
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.97218434\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.97218434\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2299.97218434"
INFO:core.logs:The pair: ETHUSDT - 2299.97218434 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42869.88573653
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42869.88573653\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42869.88573653\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42869.88573653"
INFO:core.logs:The pair: BTCUSDT - 42869.88573653 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.07530339
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.07530339\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.07530339\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.07530339"
INFO:core.logs:The pair: ETHUSDT - 2300.07530339 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42871.85750728
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42871.85750728\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42871.85750728\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42871.85750728"
INFO:core.logs:The pair: BTCUSDT - 42871.85750728 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.12822696
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.12822696\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.12822696\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.12822696"
INFO:core.logs:The pair: ETHUSDT - 2300.12822696 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCUSDT: 42873.42339918
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42873.42339918\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42873.42339918\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42873.42339918"
INFO:core.logs:The pair: BTCUSDT - 42873.42339918 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.16222740
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.16222740\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.16222740\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.16222740"
INFO:core.logs:The pair: ETHUSDT - 2300.1622274 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42877.66091555
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42877.66091555\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42877.66091555\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42877.66091555"
INFO:core.logs:The pair: BTCUSDT - 42877.66091555 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.21634173
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.21634173\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.21634173\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.21634173"
INFO:core.logs:The pair: ETHUSDT - 2300.21634173 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42879.74811460
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42879.74811460\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42879.74811460\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42879.74811460"
INFO:core.logs:The pair: BTCUSDT - 42879.7481146 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.25513316
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.25513316\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.25513316\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.25513316"
INFO:core.logs:The pair: ETHUSDT - 2300.25513316 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42878.57418070
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42878.57418070\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42878.57418070\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42878.57418070"
INFO:core.logs:The pair: BTCUSDT - 42878.5741807 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.19617719
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.19617719\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.19617719\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.19617719"
INFO:core.logs:The pair: ETHUSDT - 2300.19617719 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99672
INFO:core.logs:The pair: USDTERCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42875.77242637
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.77242637\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.77242637\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42875.77242637"
INFO:core.logs:The pair: BTCUSDT - 42875.77242637 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.11905291
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.11905291\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.11905291\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.11905291"
INFO:core.logs:The pair: ETHUSDT - 2300.11905291 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99672
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99672"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99672
INFO:core.logs:The pair: USDTTRCUSDT - 0.99672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42875.47361757
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.47361757\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.47361757\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42875.47361757"
INFO:core.logs:The pair: BTCUSDT - 42875.47361757 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.07745560
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.07745560\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.07745560\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.07745560"
INFO:core.logs:The pair: ETHUSDT - 2300.0774556 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42875.88230948
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.88230948\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42875.88230948\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42875.88230948"
INFO:core.logs:The pair: BTCUSDT - 42875.88230948 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.08446739
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.08446739\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.08446739\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.08446739"
INFO:core.logs:The pair: ETHUSDT - 2300.08446739 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 39050 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f60403798d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f60403a5060>, 18079.580790029)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6040379990>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42877.35373591
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42877.35373591\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42877.35373591\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42877.35373591"
INFO:core.logs:The pair: BTCUSDT - 42877.35373591 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.10031581
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.10031581\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.10031581\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.10031581"
INFO:core.logs:The pair: ETHUSDT - 2300.10031581 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 42827
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42827"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42827"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 42827
INFO:core.logs:The pair: BTCUSDT - 42827.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3890427
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3890427"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3890427"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3890427
INFO:core.logs:The pair: BTCRUB - 3890427.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2300.19
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2300.19"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2300.19"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2300.19
INFO:core.logs:The pair: ETHUSDT - 2300.19 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 208986
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208986"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208986"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 208986
INFO:core.logs:The pair: ETHRUB - 208986.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.61
INFO:core.logs:The pair: USDTTRCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.61
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.61"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.61
INFO:core.logs:The pair: USDTERCRUB - 90.61 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42888.47628476
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42888.47628476\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42888.47628476\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42888.47628476"
INFO:core.logs:The pair: BTCUSDT - 42888.47628476 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.03035250
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.03035250\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.03035250\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.03035250"
INFO:core.logs:The pair: ETHUSDT - 2301.0303525 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42890.65079261
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42890.65079261\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42890.65079261\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42890.65079261"
INFO:core.logs:The pair: BTCUSDT - 42890.65079261 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.48207413
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.48207413\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.48207413\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.48207413"
INFO:core.logs:The pair: ETHUSDT - 2301.48207413 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42891.13231522
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42891.13231522\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42891.13231522\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42891.13231522"
INFO:core.logs:The pair: BTCUSDT - 42891.13231522 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.49171610
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.49171610\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.49171610\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.49171610"
INFO:core.logs:The pair: ETHUSDT - 2301.4917161 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42889.21488984
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42889.21488984\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42889.21488984\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42889.21488984"
INFO:core.logs:The pair: BTCUSDT - 42889.21488984 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.42162872
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.42162872\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.42162872\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.42162872"
INFO:core.logs:The pair: ETHUSDT - 2301.42162872 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42888.72236011
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42888.72236011\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42888.72236011\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42888.72236011"
INFO:core.logs:The pair: BTCUSDT - 42888.72236011 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.41366800
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.41366800\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.41366800\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.41366800"
INFO:core.logs:The pair: ETHUSDT - 2301.413668 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 39213 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f19c1a59990>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f19c1aa9420>, 18236.473247086)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f19c1a59690>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42886.91095434
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42886.91095434\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42886.91095434\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42886.91095434"
INFO:core.logs:The pair: BTCUSDT - 42886.91095434 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2301.32760141
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.32760141\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2301.32760141\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2301.32760141"
INFO:core.logs:The pair: ETHUSDT - 2301.32760141 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42869.30746989
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42869.30746989\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42869.30746989\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42869.30746989"
INFO:core.logs:The pair: BTCUSDT - 42869.30746989 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2300.68933316
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.68933316\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2300.68933316\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2300.68933316"
INFO:core.logs:The pair: ETHUSDT - 2300.68933316 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42828.91397029
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42828.91397029\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42828.91397029\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42828.91397029"
INFO:core.logs:The pair: BTCUSDT - 42828.91397029 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2299.46117400
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.46117400\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2299.46117400\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2299.46117400"
INFO:core.logs:The pair: ETHUSDT - 2299.461174 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998628
INFO:core.logs:The pair: USDTERCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42817.30858412
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42817.30858412\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42817.30858412\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42817.30858412"
INFO:core.logs:The pair: BTCUSDT - 42817.30858412 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2298.36008430
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.36008430\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.36008430\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2298.36008430"
INFO:core.logs:The pair: ETHUSDT - 2298.3600843 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42813.45405596
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42813.45405596\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42813.45405596\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42813.45405596"
INFO:core.logs:The pair: BTCUSDT - 42813.45405596 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2298.35341447
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.35341447\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.35341447\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2298.35341447"
INFO:core.logs:The pair: ETHUSDT - 2298.35341447 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998628
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998628"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998628
INFO:core.logs:The pair: USDTTRCUSDT - 0.998628 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.78
INFO:core.logs:The pair: USDTERCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42806.71322811
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42806.71322811\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42806.71322811\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42806.71322811"
INFO:core.logs:The pair: BTCUSDT - 42806.71322811 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2298.37358721
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.37358721\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.37358721\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2298.37358721"
INFO:core.logs:The pair: ETHUSDT - 2298.37358721 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42794.21847722
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42794.21847722\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42794.21847722\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42794.21847722"
INFO:core.logs:The pair: BTCUSDT - 42794.21847722 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2298.31157718
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.31157718\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.31157718\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2298.31157718"
INFO:core.logs:The pair: ETHUSDT - 2298.31157718 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.78
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.78"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.78
INFO:core.logs:The pair: USDTTRCRUB - 90.78 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42784.38218236
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42784.38218236\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42784.38218236\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42784.38218236"
INFO:core.logs:The pair: BTCUSDT - 42784.38218236 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2298.08851331
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.08851331\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2298.08851331\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2298.08851331"
INFO:core.logs:The pair: ETHUSDT - 2298.08851331 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42771.84860365
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42771.84860365\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42771.84860365\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42771.84860365"
INFO:core.logs:The pair: BTCUSDT - 42771.84860365 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2297.56973855
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.56973855\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.56973855\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2297.56973855"
INFO:core.logs:The pair: ETHUSDT - 2297.56973855 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42767.79442725
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42767.79442725\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42767.79442725\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42767.79442725"
INFO:core.logs:The pair: BTCUSDT - 42767.79442725 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2298.81
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2298.81"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2298.81"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2298.81
INFO:core.logs:The pair: ETHUSDT - 2298.81 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 209202
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "209202"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "209202"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 209202
INFO:core.logs:The pair: ETHRUB - 209202.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42763.88857869
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42763.88857869\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42763.88857869\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42763.88857869"
INFO:core.logs:The pair: BTCUSDT - 42763.88857869 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2297.31116030
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.31116030\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.31116030\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2297.31116030"
INFO:core.logs:The pair: ETHUSDT - 2297.3111603 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42752.24492069
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.24492069\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.24492069\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42752.24492069"
INFO:core.logs:The pair: BTCUSDT - 42752.24492069 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2297.02697710
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.02697710\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2297.02697710\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2297.02697710"
INFO:core.logs:The pair: ETHUSDT - 2297.0269771 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999395
INFO:core.logs:The pair: USDTERCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 18, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 36, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 39399 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff4a4a4d930>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7ff4a4a79480>, 18533.759466287)]']
connector: <aiohttp.connector.TCPConnector object at 0x7ff4a4a4d900>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42738.70527553
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42738.70527553\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42738.70527553\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42738.70527553"
INFO:core.logs:The pair: BTCUSDT - 42738.70527553 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2296.53292353
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2296.53292353\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2296.53292353\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2296.53292353"
INFO:core.logs:The pair: ETHUSDT - 2296.53292353 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42733.63416533
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42733.63416533\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42733.63416533\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42733.63416533"
INFO:core.logs:The pair: BTCUSDT - 42733.63416533 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2296.33952433
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2296.33952433\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2296.33952433\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2296.33952433"
INFO:core.logs:The pair: ETHUSDT - 2296.33952433 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42718.47575902
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42718.47575902\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42718.47575902\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42718.47575902"
INFO:core.logs:The pair: BTCUSDT - 42718.47575902 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2295.58612837
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2295.58612837\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2295.58612837\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2295.58612837"
INFO:core.logs:The pair: ETHUSDT - 2295.58612837 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42685.46676753
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42685.46676753\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42685.46676753\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42685.46676753"
INFO:core.logs:The pair: BTCUSDT - 42685.46676753 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2294.49559191
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2294.49559191\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2294.49559191\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2294.49559191"
INFO:core.logs:The pair: ETHUSDT - 2294.49559191 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999395
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999395"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999395
INFO:core.logs:The pair: USDTTRCUSDT - 0.999395 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42676.18488702
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42676.18488702\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42676.18488702\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42676.18488702"
INFO:core.logs:The pair: BTCUSDT - 42676.18488702 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2293.95333286
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2293.95333286\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2293.95333286\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2293.95333286"
INFO:core.logs:The pair: ETHUSDT - 2293.95333286 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 39608 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f47658775e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42667.93149653
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42667.93149653\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42667.93149653\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42667.93149653"
INFO:core.logs:The pair: BTCUSDT - 42667.93149653 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2292.69342052
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.69342052\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.69342052\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2292.69342052"
INFO:core.logs:The pair: ETHUSDT - 2292.69342052 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42659.08447575
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42659.08447575\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42659.08447575\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42659.08447575"
INFO:core.logs:The pair: BTCUSDT - 42659.08447575 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2292.18233260
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.18233260\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.18233260\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2292.18233260"
INFO:core.logs:The pair: ETHUSDT - 2292.1823326 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42645.26753366
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42645.26753366\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42645.26753366\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42645.26753366"
INFO:core.logs:The pair: BTCUSDT - 42645.26753366 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2292.03947853
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.03947853\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.03947853\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2292.03947853"
INFO:core.logs:The pair: ETHUSDT - 2292.03947853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.85
INFO:core.logs:The pair: USDTTRCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42639.07014037
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42639.07014037\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42639.07014037\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42639.07014037"
INFO:core.logs:The pair: BTCUSDT - 42639.07014037 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.90059746
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.90059746\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.90059746\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.90059746"
INFO:core.logs:The pair: ETHUSDT - 2291.90059746 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42636.26717315
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42636.26717315\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42636.26717315\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42636.26717315"
INFO:core.logs:The pair: BTCUSDT - 42636.26717315 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.76202410
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.76202410\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.76202410\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.76202410"
INFO:core.logs:The pair: ETHUSDT - 2291.7620241 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42633.36244262
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42633.36244262\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42633.36244262\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42633.36244262"
INFO:core.logs:The pair: BTCUSDT - 42633.36244262 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.53582440
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.53582440\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.53582440\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.53582440"
INFO:core.logs:The pair: ETHUSDT - 2291.5358244 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.85
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.85"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.85
INFO:core.logs:The pair: USDTERCRUB - 90.85 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42629.64658472
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42629.64658472\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42629.64658472\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42629.64658472"
INFO:core.logs:The pair: BTCUSDT - 42629.64658472 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.42528341
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.42528341\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.42528341\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.42528341"
INFO:core.logs:The pair: ETHUSDT - 2291.42528341 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42630.06028027
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42630.06028027\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42630.06028027\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42630.06028027"
INFO:core.logs:The pair: BTCUSDT - 42630.06028027 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.46656952
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.46656952\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.46656952\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.46656952"
INFO:core.logs:The pair: ETHUSDT - 2291.46656952 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42625.69332887
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.69332887\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.69332887\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42625.69332887"
INFO:core.logs:The pair: BTCUSDT - 42625.69332887 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.37670946
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.37670946\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.37670946\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.37670946"
INFO:core.logs:The pair: ETHUSDT - 2291.37670946 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42620.71214503
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42620.71214503\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42620.71214503\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42620.71214503"
INFO:core.logs:The pair: BTCUSDT - 42620.71214503 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.40544346
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.40544346\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.40544346\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.40544346"
INFO:core.logs:The pair: ETHUSDT - 2291.40544346 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42617.18916791
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42617.18916791\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42617.18916791\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42617.18916791"
INFO:core.logs:The pair: BTCUSDT - 42617.18916791 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.26312084
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.26312084\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.26312084\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.26312084"
INFO:core.logs:The pair: ETHUSDT - 2291.26312084 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42612.83700585
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42612.83700585\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42612.83700585\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42612.83700585"
INFO:core.logs:The pair: BTCUSDT - 42612.83700585 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.17630338
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.17630338\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.17630338\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.17630338"
INFO:core.logs:The pair: ETHUSDT - 2291.17630338 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42620.21029736
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42620.21029736\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42620.21029736\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42620.21029736"
INFO:core.logs:The pair: BTCUSDT - 42620.21029736 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.30140167
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.30140167\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.30140167\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.30140167"
INFO:core.logs:The pair: ETHUSDT - 2291.30140167 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42625.73102796
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.73102796\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.73102796\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42625.73102796"
INFO:core.logs:The pair: BTCUSDT - 42625.73102796 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.46886873
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.46886873\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.46886873\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.46886873"
INFO:core.logs:The pair: ETHUSDT - 2291.46886873 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997238
INFO:core.logs:The pair: USDTERCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42625.80784253
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.80784253\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.80784253\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42625.80784253"
INFO:core.logs:The pair: BTCUSDT - 42625.80784253 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.61908720
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.61908720\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.61908720\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.61908720"
INFO:core.logs:The pair: ETHUSDT - 2291.6190872 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997238
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997238"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997238
INFO:core.logs:The pair: USDTTRCUSDT - 0.997238 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42625.34896506
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.34896506\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42625.34896506\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42625.34896506"
INFO:core.logs:The pair: BTCUSDT - 42625.34896506 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.53472104
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.53472104\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.53472104\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.53472104"
INFO:core.logs:The pair: ETHUSDT - 2291.53472104 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42623.64173729
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42623.64173729\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42623.64173729\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42623.64173729"
INFO:core.logs:The pair: BTCUSDT - 42623.64173729 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.47738727
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.47738727\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.47738727\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.47738727"
INFO:core.logs:The pair: ETHUSDT - 2291.47738727 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42621.71469474
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.71469474\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.71469474\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42621.71469474"
INFO:core.logs:The pair: BTCUSDT - 42621.71469474 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.39194526
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.39194526\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.39194526\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.39194526"
INFO:core.logs:The pair: ETHUSDT - 2291.39194526 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42621.51945909
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.51945909\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.51945909\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42621.51945909"
INFO:core.logs:The pair: BTCUSDT - 42621.51945909 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.30404580
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.30404580\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.30404580\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.30404580"
INFO:core.logs:The pair: ETHUSDT - 2291.3040458 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997838
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997838
INFO:core.logs:The pair: USDTERCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42621.97289325
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.97289325\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42621.97289325\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42621.97289325"
INFO:core.logs:The pair: BTCUSDT - 42621.97289325 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.25210524
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.25210524\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.25210524\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.25210524"
INFO:core.logs:The pair: ETHUSDT - 2291.25210524 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997838
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997838
INFO:core.logs:The pair: USDTERCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42624.24895599
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42624.24895599\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42624.24895599\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42624.24895599"
INFO:core.logs:The pair: BTCUSDT - 42624.24895599 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.21707936
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.21707936\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.21707936\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.21707936"
INFO:core.logs:The pair: ETHUSDT - 2291.21707936 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42624.61885704
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42624.61885704\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42624.61885704\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42624.61885704"
INFO:core.logs:The pair: BTCUSDT - 42624.61885704 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.15145996
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.15145996\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.15145996\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.15145996"
INFO:core.logs:The pair: ETHUSDT - 2291.15145996 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.66
INFO:core.logs:The pair: USDTTRCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 39691 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f5247e8b610>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f5248cd46a0>, 19090.812219414)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f5247e8a0e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCUSDT: 42627.88202112
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42627.88202112\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42627.88202112\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42627.88202112"
INFO:core.logs:The pair: BTCUSDT - 42627.88202112 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.12690047
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.12690047\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.12690047\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.12690047"
INFO:core.logs:The pair: ETHUSDT - 2291.12690047 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.66
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.66"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.66
INFO:core.logs:The pair: USDTERCRUB - 90.66 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42632.18490061
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42632.18490061\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42632.18490061\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42632.18490061"
INFO:core.logs:The pair: BTCUSDT - 42632.18490061 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.87343206
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.87343206\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.87343206\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.87343206"
INFO:core.logs:The pair: ETHUSDT - 2290.87343206 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42638.13499060
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42638.13499060\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42638.13499060\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42638.13499060"
INFO:core.logs:The pair: BTCUSDT - 42638.1349906 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.84506171
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.84506171\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.84506171\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.84506171"
INFO:core.logs:The pair: ETHUSDT - 2290.84506171 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42640.52378282
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42640.52378282\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42640.52378282\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42640.52378282"
INFO:core.logs:The pair: BTCUSDT - 42640.52378282 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.78690437
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.78690437\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.78690437\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.78690437"
INFO:core.logs:The pair: ETHUSDT - 2290.78690437 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42643.48741371
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42643.48741371\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42643.48741371\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42643.48741371"
INFO:core.logs:The pair: BTCUSDT - 42643.48741371 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.74300824
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.74300824\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.74300824\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.74300824"
INFO:core.logs:The pair: ETHUSDT - 2290.74300824 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42645.04622619
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42645.04622619\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42645.04622619\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42645.04622619"
INFO:core.logs:The pair: BTCUSDT - 42645.04622619 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.57248273
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.57248273\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.57248273\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.57248273"
INFO:core.logs:The pair: ETHUSDT - 2290.57248273 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40049 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fca3687b700>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fca368a91e0>, 19195.199444506)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fca3687a1d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42646.33088299
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.33088299\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.33088299\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42646.33088299"
INFO:core.logs:The pair: BTCUSDT - 42646.33088299 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.23611188
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.23611188\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.23611188\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.23611188"
INFO:core.logs:The pair: ETHUSDT - 2290.23611188 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997838
INFO:core.logs:The pair: USDTERCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42647.74538760
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42647.74538760\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42647.74538760\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42647.74538760"
INFO:core.logs:The pair: BTCUSDT - 42647.7453876 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.94719611
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.94719611\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.94719611\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.94719611"
INFO:core.logs:The pair: ETHUSDT - 2289.94719611 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.997838
INFO:core.logs:The pair: USDTERCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42650.38589333
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42650.38589333\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42650.38589333\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42650.38589333"
INFO:core.logs:The pair: BTCUSDT - 42650.38589333 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.79265076
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.79265076\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.79265076\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.79265076"
INFO:core.logs:The pair: ETHUSDT - 2289.79265076 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42652.79755863
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.79755863\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.79755863\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42652.79755863"
INFO:core.logs:The pair: BTCUSDT - 42652.79755863 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.31417306
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.31417306\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.31417306\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.31417306"
INFO:core.logs:The pair: ETHUSDT - 2287.31417306 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.997838
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.997838"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.997838
INFO:core.logs:The pair: USDTTRCUSDT - 0.997838 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40147 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6c31d736a0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f6c31da1a80>, 19303.806636953)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6c31d72170>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42653.83504251
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.83504251\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.83504251\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42653.83504251"
INFO:core.logs:The pair: BTCUSDT - 42653.83504251 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.82263851
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.82263851\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.82263851\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.82263851"
INFO:core.logs:The pair: ETHUSDT - 2286.82263851 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42652.89917242
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.89917242\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.89917242\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42652.89917242"
INFO:core.logs:The pair: BTCUSDT - 42652.89917242 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.28538438
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.28538438\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.28538438\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.28538438"
INFO:core.logs:The pair: ETHUSDT - 2286.28538438 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42652.43024790
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.43024790\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.43024790\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42652.43024790"
INFO:core.logs:The pair: BTCUSDT - 42652.4302479 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.55704197
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.55704197\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.55704197\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.55704197"
INFO:core.logs:The pair: ETHUSDT - 2285.55704197 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42652.16979448
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.16979448\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.16979448\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42652.16979448"
INFO:core.logs:The pair: BTCUSDT - 42652.16979448 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.38448869
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.38448869\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.38448869\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.38448869"
INFO:core.logs:The pair: ETHUSDT - 2285.38448869 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42649.85051057
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42649.85051057\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42649.85051057\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42649.85051057"
INFO:core.logs:The pair: BTCUSDT - 42649.85051057 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.03043764
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.03043764\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.03043764\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.03043764"
INFO:core.logs:The pair: ETHUSDT - 2285.03043764 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42647.06983040
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42647.06983040\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42647.06983040\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42647.06983040"
INFO:core.logs:The pair: BTCUSDT - 42647.0698304 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.78549643
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.78549643\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.78549643\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.78549643"
INFO:core.logs:The pair: ETHUSDT - 2284.78549643 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40260 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f2b8a3835e0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f2b8b2e0820>, 19431.715155077)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f2b8a3820b0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42646.72055336
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.72055336\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.72055336\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42646.72055336"
INFO:core.logs:The pair: BTCUSDT - 42646.72055336 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.69982842
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.69982842\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.69982842\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.69982842"
INFO:core.logs:The pair: ETHUSDT - 2284.69982842 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42646.96512478
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.96512478\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42646.96512478\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42646.96512478"
INFO:core.logs:The pair: BTCUSDT - 42646.96512478 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.56943847
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.56943847\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.56943847\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.56943847"
INFO:core.logs:The pair: ETHUSDT - 2284.56943847 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42652.97837018
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.97837018\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42652.97837018\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42652.97837018"
INFO:core.logs:The pair: BTCUSDT - 42652.97837018 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 40359 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fd28b68b5b0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42653.78691759
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.78691759\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.78691759\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42653.78691759"
INFO:core.logs:The pair: BTCUSDT - 42653.78691759 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.57707975
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.57707975\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.57707975\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.57707975"
INFO:core.logs:The pair: ETHUSDT - 2284.57707975 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42654.44444449
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42654.44444449\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42654.44444449\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42654.44444449"
INFO:core.logs:The pair: BTCUSDT - 42654.44444449 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.49252157
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.49252157\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.49252157\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.49252157"
INFO:core.logs:The pair: ETHUSDT - 2284.49252157 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42653.45866128
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.45866128\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42653.45866128\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42653.45866128"
INFO:core.logs:The pair: BTCUSDT - 42653.45866128 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2284.36119583
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.36119583\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2284.36119583\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2284.36119583"
INFO:core.logs:The pair: ETHUSDT - 2284.36119583 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999424
INFO:core.logs:The pair: USDTERCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.89
INFO:core.logs:The pair: USDTERCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42658.85490605
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42658.85490605\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42658.85490605\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42658.85490605"
INFO:core.logs:The pair: BTCUSDT - 42658.85490605 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.01464508
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.01464508\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.01464508\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.01464508"
INFO:core.logs:The pair: ETHUSDT - 2285.01464508 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42662.98019933
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42662.98019933\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42662.98019933\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42662.98019933"
INFO:core.logs:The pair: BTCUSDT - 42662.98019933 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.25432911
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.25432911\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.25432911\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.25432911"
INFO:core.logs:The pair: ETHUSDT - 2285.25432911 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40414 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fd613d76f50>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fd613da5120>, 19606.56202981)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fd613d77010>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42666.58538769
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42666.58538769\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42666.58538769\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42666.58538769"
INFO:core.logs:The pair: BTCUSDT - 42666.58538769 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2285.48934991
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.48934991\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2285.48934991\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2285.48934991"
INFO:core.logs:The pair: ETHUSDT - 2285.48934991 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999424
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999424"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999424
INFO:core.logs:The pair: USDTTRCUSDT - 0.999424 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42670.79394357
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.79394357\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.79394357\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42670.79394357"
INFO:core.logs:The pair: BTCUSDT - 42670.79394357 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.28737733
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.28737733\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.28737733\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.28737733"
INFO:core.logs:The pair: ETHUSDT - 2286.28737733 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42674.10741397
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42674.10741397\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42674.10741397\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42674.10741397"
INFO:core.logs:The pair: BTCUSDT - 42674.10741397 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.55930867
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.55930867\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.55930867\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.55930867"
INFO:core.logs:The pair: ETHUSDT - 2286.55930867 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42675.99889274
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.99889274\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.99889274\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42675.99889274"
INFO:core.logs:The pair: BTCUSDT - 42675.99889274 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.88113003
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.88113003\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.88113003\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.88113003"
INFO:core.logs:The pair: ETHUSDT - 2286.88113003 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.89
INFO:core.logs:The pair: USDTTRCRUB - 90.89 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42692.98192830
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42692.98192830\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42692.98192830\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42692.98192830"
INFO:core.logs:The pair: BTCUSDT - 42692.9819283 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.44114829
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.44114829\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.44114829\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.44114829"
INFO:core.logs:The pair: ETHUSDT - 2287.44114829 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42698.12265033
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42698.12265033\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42698.12265033\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42698.12265033"
INFO:core.logs:The pair: BTCUSDT - 42698.12265033 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.60779960
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.60779960\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.60779960\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.60779960"
INFO:core.logs:The pair: ETHUSDT - 2287.6077996 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.89
INFO:core.logs:The pair: USDTERCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42699.83041183
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42699.83041183\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42699.83041183\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42699.83041183"
INFO:core.logs:The pair: BTCUSDT - 42699.83041183 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.76823095
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.76823095\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.76823095\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.76823095"
INFO:core.logs:The pair: ETHUSDT - 2287.76823095 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.89
INFO:core.logs:The pair: USDTERCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42703.90577269
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42703.90577269\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42703.90577269\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42703.90577269"
INFO:core.logs:The pair: BTCUSDT - 42703.90577269 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.86236641
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.86236641\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.86236641\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.86236641"
INFO:core.logs:The pair: ETHUSDT - 2287.86236641 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42706.55876926
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42706.55876926\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42706.55876926\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42706.55876926"
INFO:core.logs:The pair: BTCUSDT - 42706.55876926 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.90942758
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.90942758\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.90942758\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.90942758"
INFO:core.logs:The pair: ETHUSDT - 2287.90942758 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998853
INFO:core.logs:The pair: USDTTRCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40504 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f84afb73640>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f84afba10c0>, 19798.885567469)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f84afb72110>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42716.45546144
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42716.45546144\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42716.45546144\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42716.45546144"
INFO:core.logs:The pair: BTCUSDT - 42716.45546144 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.19502466
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.19502466\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.19502466\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.19502466"
INFO:core.logs:The pair: ETHUSDT - 2288.19502466 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42722.42399522
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42722.42399522\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42722.42399522\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42722.42399522"
INFO:core.logs:The pair: BTCUSDT - 42722.42399522 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.02775206
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.02775206\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.02775206\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.02775206"
INFO:core.logs:The pair: ETHUSDT - 2289.02775206 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.89
INFO:core.logs:The pair: USDTTRCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998853
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998853"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998853
INFO:core.logs:The pair: USDTERCUSDT - 0.998853 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42727.25133462
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42727.25133462\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42727.25133462\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42727.25133462"
INFO:core.logs:The pair: BTCUSDT - 42727.25133462 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.23320648
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.23320648\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.23320648\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.23320648"
INFO:core.logs:The pair: ETHUSDT - 2289.23320648 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.89
INFO:core.logs:The pair: USDTTRCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.89
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.89"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.89
INFO:core.logs:The pair: USDTERCRUB - 90.89 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42733.24878508
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42733.24878508\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42733.24878508\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42733.24878508"
INFO:core.logs:The pair: BTCUSDT - 42733.24878508 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.79489426
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.79489426\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.79489426\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.79489426"
INFO:core.logs:The pair: ETHUSDT - 2289.79489426 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 40712 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fdbcd552c50>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fdbcd5810c0>, 19875.987747766)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fdbcd552da0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42734.83838369
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42734.83838369\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42734.83838369\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42734.83838369"
INFO:core.logs:The pair: BTCUSDT - 42734.83838369 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.93867731
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.93867731\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.93867731\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.93867731"
INFO:core.logs:The pair: ETHUSDT - 2289.93867731 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42741.91102562
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42741.91102562\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42741.91102562\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42741.91102562"
INFO:core.logs:The pair: BTCUSDT - 42741.91102562 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.15361792
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.15361792\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.15361792\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.15361792"
INFO:core.logs:The pair: ETHUSDT - 2290.15361792 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42746.68032604
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42746.68032604\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42746.68032604\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42746.68032604"
INFO:core.logs:The pair: BTCUSDT - 42746.68032604 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.44259981
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.44259981\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.44259981\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.44259981"
INFO:core.logs:The pair: ETHUSDT - 2290.44259981 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337dae0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7897, in _request
    async with getattr(self.session, method)(uri, **kwargs) as response:
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 605, in _request
    await resp.start(conn)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 961, in start
    with self._timer:
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/helpers.py", line 735, in __exit__
    raise asyncio.TimeoutError from None
asyncio.exceptions.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 210, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7f625337dae0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337dae0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 34, in get_pair_info
    response = requests.get(f"{base_url}?ids={params['ids']}&vs_currencies={params['vs_currencies']}")
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337dae0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=usd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337f8b0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 855, in getaddrinfo
    return await self.run_in_executor(
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7897, in _request
    async with getattr(self.session, method)(uri, **kwargs) as response:
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.binance.com:443 ssl:default [Temporary failure in name resolution]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 210, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7f625337f8b0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=usd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337f8b0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 34, in get_pair_info
    response = requests.get(f"{base_url}?ids={params['ids']}&vs_currencies={params['vs_currencies']}")
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=usd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625337f8b0>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625344b460>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 1173, in _create_direct_connection
    hosts = await asyncio.shield(host_resolved)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 884, in _resolve_host
    addrs = await self._resolver.resolve(host, port, family=self._family)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/resolver.py", line 33, in resolve
    infos = await self._loop.getaddrinfo(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 855, in getaddrinfo
    return await self.run_in_executor(
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7897, in _request
    async with getattr(self.session, method)(uri, **kwargs) as response:
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 1194, in __aenter__
    self._resp = await self._coro
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/client.py", line 578, in _request
    conn = await self._connector.connect(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiohttp/connector.py", line 1187, in _create_direct_connection
    raise ClientConnectorError(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.binance.com:443 ssl:default [Temporary failure in name resolution]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -3] Temporary failure in name resolution

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connection.py", line 210, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x7f625344b460>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625344b460>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 34, in get_pair_info
    response = requests.get(f"{base_url}?ids={params['ids']}&vs_currencies={params['vs_currencies']}")
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.coingecko.com', port=443): Max retries exceeded with url: /api/v3/simple/price?ids=tether&vs_currencies=rub (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f625344b460>: Failed to resolve 'api.coingecko.com' ([Errno -3] Temporary failure in name resolution)"))
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 42732
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42732"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42732"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 42732
INFO:core.logs:The pair: BTCUSDT - 42732.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3888242
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3888242"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3888242"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3888242
INFO:core.logs:The pair: BTCRUB - 3888242.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2290.17
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2290.17"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2290.17"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2290.17
INFO:core.logs:The pair: ETHUSDT - 2290.17 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 208423
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208423"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208423"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 208423
INFO:core.logs:The pair: ETHRUB - 208423.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42770.16237829
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42770.16237829\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42770.16237829\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42770.16237829"
INFO:core.logs:The pair: BTCUSDT - 42770.16237829 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2292.22809408
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.22809408\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2292.22809408\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2292.22809408"
INFO:core.logs:The pair: ETHUSDT - 2292.22809408 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42765.83781996
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42765.83781996\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42765.83781996\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42765.83781996"
INFO:core.logs:The pair: BTCUSDT - 42765.83781996 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.98266031
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.98266031\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.98266031\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.98266031"
INFO:core.logs:The pair: ETHUSDT - 2291.98266031 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42761.27477234
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42761.27477234\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42761.27477234\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42761.27477234"
INFO:core.logs:The pair: BTCUSDT - 42761.27477234 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.90896513
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.90896513\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.90896513\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.90896513"
INFO:core.logs:The pair: ETHUSDT - 2291.90896513 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42756.06825685
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42756.06825685\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42756.06825685\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42756.06825685"
INFO:core.logs:The pair: BTCUSDT - 42756.06825685 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.63337648
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.63337648\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.63337648\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.63337648"
INFO:core.logs:The pair: ETHUSDT - 2291.63337648 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42751.20452046
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.20452046\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.20452046\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42751.20452046"
INFO:core.logs:The pair: BTCUSDT - 42751.20452046 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.31153180
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.31153180\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.31153180\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.31153180"
INFO:core.logs:The pair: ETHUSDT - 2291.3115318 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42748.97762189
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42748.97762189\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42748.97762189\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42748.97762189"
INFO:core.logs:The pair: BTCUSDT - 42748.97762189 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.85816009
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.85816009\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.85816009\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.85816009"
INFO:core.logs:The pair: ETHUSDT - 2290.85816009 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999411
INFO:core.logs:The pair: USDTERCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42744.87406497
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42744.87406497\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42744.87406497\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42744.87406497"
INFO:core.logs:The pair: BTCUSDT - 42744.87406497 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.64000301
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.64000301\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.64000301\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.64000301"
INFO:core.logs:The pair: ETHUSDT - 2290.64000301 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.94
INFO:core.logs:The pair: USDTERCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42741.12078476
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42741.12078476\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42741.12078476\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42741.12078476"
INFO:core.logs:The pair: BTCUSDT - 42741.12078476 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.55635845
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.55635845\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.55635845\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.55635845"
INFO:core.logs:The pair: ETHUSDT - 2290.55635845 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.94
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.94"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.94
INFO:core.logs:The pair: USDTTRCRUB - 90.94 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42739.72952241
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42739.72952241\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42739.72952241\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42739.72952241"
INFO:core.logs:The pair: BTCUSDT - 42739.72952241 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.47964983
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.47964983\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.47964983\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.47964983"
INFO:core.logs:The pair: ETHUSDT - 2290.47964983 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999411
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999411"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999411
INFO:core.logs:The pair: USDTTRCUSDT - 0.999411 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42737.38775404
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42737.38775404\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42737.38775404\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42737.38775404"
INFO:core.logs:The pair: BTCUSDT - 42737.38775404 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.35163136
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.35163136\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.35163136\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.35163136"
INFO:core.logs:The pair: ETHUSDT - 2290.35163136 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42735.38827343
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42735.38827343\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42735.38827343\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42735.38827343"
INFO:core.logs:The pair: BTCUSDT - 42735.38827343 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.14945461
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.14945461\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.14945461\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.14945461"
INFO:core.logs:The pair: ETHUSDT - 2290.14945461 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42732.92090697
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42732.92090697\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42732.92090697\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42732.92090697"
INFO:core.logs:The pair: BTCUSDT - 42732.92090697 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.03792550
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.03792550\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.03792550\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.03792550"
INFO:core.logs:The pair: ETHUSDT - 2290.0379255 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42730.76337359
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42730.76337359\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42730.76337359\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42730.76337359"
INFO:core.logs:The pair: BTCUSDT - 42730.76337359 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.92298373
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.92298373\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.92298373\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.92298373"
INFO:core.logs:The pair: ETHUSDT - 2289.92298373 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42730.60699414
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42730.60699414\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42730.60699414\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42730.60699414"
INFO:core.logs:The pair: BTCUSDT - 42730.60699414 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.83221427
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.83221427\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.83221427\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.83221427"
INFO:core.logs:The pair: ETHUSDT - 2289.83221427 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42728.67733866
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42728.67733866\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42728.67733866\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42728.67733866"
INFO:core.logs:The pair: BTCUSDT - 42728.67733866 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.49059581
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.49059581\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.49059581\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.49059581"
INFO:core.logs:The pair: ETHUSDT - 2289.49059581 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42725.46993195
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.46993195\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.46993195\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42725.46993195"
INFO:core.logs:The pair: BTCUSDT - 42725.46993195 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 40794 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6253282c50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42725.23153837
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.23153837\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.23153837\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42725.23153837"
INFO:core.logs:The pair: BTCUSDT - 42725.23153837 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.98682708
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.98682708\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.98682708\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.98682708"
INFO:core.logs:The pair: ETHUSDT - 2288.98682708 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42721.77016293
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42721.77016293\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42721.77016293\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42721.77016293"
INFO:core.logs:The pair: BTCUSDT - 42721.77016293 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.82377794
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.82377794\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.82377794\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.82377794"
INFO:core.logs:The pair: ETHUSDT - 2288.82377794 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42713.21483646
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42713.21483646\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42713.21483646\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42713.21483646"
INFO:core.logs:The pair: BTCUSDT - 42713.21483646 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.34924144
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.34924144\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.34924144\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.34924144"
INFO:core.logs:The pair: ETHUSDT - 2288.34924144 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42709.56904725
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42709.56904725\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42709.56904725\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42709.56904725"
INFO:core.logs:The pair: BTCUSDT - 42709.56904725 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.10181929
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.10181929\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.10181929\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.10181929"
INFO:core.logs:The pair: ETHUSDT - 2288.10181929 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42705.32148269
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42705.32148269\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42705.32148269\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42705.32148269"
INFO:core.logs:The pair: BTCUSDT - 42705.32148269 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.97196591
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.97196591\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.97196591\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.97196591"
INFO:core.logs:The pair: ETHUSDT - 2287.97196591 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.87
INFO:core.logs:The pair: USDTERCRUB - 90.87 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 41499 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f367176f730>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f367179d060>, 20330.605459653)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f367176e200>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42704.08557107
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42704.08557107\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42704.08557107\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42704.08557107"
INFO:core.logs:The pair: BTCUSDT - 42704.08557107 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.88883593
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.88883593\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.88883593\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.88883593"
INFO:core.logs:The pair: ETHUSDT - 2287.88883593 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42702.34018272
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42702.34018272\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42702.34018272\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42702.34018272"
INFO:core.logs:The pair: BTCUSDT - 42702.34018272 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.78715480
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.78715480\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.78715480\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.78715480"
INFO:core.logs:The pair: ETHUSDT - 2287.7871548 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 91.02
INFO:core.logs:The pair: USDTTRCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42701.78389976
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42701.78389976\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42701.78389976\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42701.78389976"
INFO:core.logs:The pair: BTCUSDT - 42701.78389976 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.70946287
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.70946287\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.70946287\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.70946287"
INFO:core.logs:The pair: ETHUSDT - 2287.70946287 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 41602 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fd183367730>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fd183285120>, 20380.368364479)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fd183366200>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42699.71263133
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42699.71263133\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42699.71263133\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42699.71263133"
INFO:core.logs:The pair: BTCUSDT - 42699.71263133 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.61872361
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.61872361\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.61872361\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.61872361"
INFO:core.logs:The pair: ETHUSDT - 2287.61872361 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42697.45410303
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42697.45410303\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42697.45410303\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42697.45410303"
INFO:core.logs:The pair: BTCUSDT - 42697.45410303 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.57549609
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.57549609\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.57549609\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.57549609"
INFO:core.logs:The pair: ETHUSDT - 2287.57549609 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42693.17585600
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42693.17585600\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42693.17585600\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42693.17585600"
INFO:core.logs:The pair: BTCUSDT - 42693.175856 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.38306241
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.38306241\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.38306241\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.38306241"
INFO:core.logs:The pair: ETHUSDT - 2287.38306241 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42688.09633505
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42688.09633505\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42688.09633505\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42688.09633505"
INFO:core.logs:The pair: BTCUSDT - 42688.09633505 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 41667 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fa751e76c80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42687.91207793
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42687.91207793\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42687.91207793\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42687.91207793"
INFO:core.logs:The pair: BTCUSDT - 42687.91207793 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.28568596
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.28568596\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.28568596\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.28568596"
INFO:core.logs:The pair: ETHUSDT - 2287.28568596 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 91.02
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "91.02"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 91.02
INFO:core.logs:The pair: USDTERCRUB - 91.02 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 41730 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f7462082f80>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f74620b1060>, 20482.810303396)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f7462083040>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42679.34346528
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42679.34346528\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42679.34346528\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42679.34346528"
INFO:core.logs:The pair: BTCUSDT - 42679.34346528 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.11660592
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.11660592\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.11660592\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.11660592"
INFO:core.logs:The pair: ETHUSDT - 2287.11660592 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42675.29026983
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.29026983\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.29026983\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42675.29026983"
INFO:core.logs:The pair: BTCUSDT - 42675.29026983 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.81652584
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.81652584\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.81652584\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.81652584"
INFO:core.logs:The pair: ETHUSDT - 2286.81652584 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42674.05178466
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42674.05178466\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42674.05178466\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42674.05178466"
INFO:core.logs:The pair: BTCUSDT - 42674.05178466 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2286.95101916
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.95101916\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2286.95101916\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2286.95101916"
INFO:core.logs:The pair: ETHUSDT - 2286.95101916 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.87
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.87"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.87
INFO:core.logs:The pair: USDTTRCRUB - 90.87 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42669.01843609
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42669.01843609\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42669.01843609\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42669.01843609"
INFO:core.logs:The pair: BTCUSDT - 42669.01843609 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.05629010
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.05629010\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.05629010\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.05629010"
INFO:core.logs:The pair: ETHUSDT - 2287.0562901 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 41796 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fed8c47f7c0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCUSDT: 42671.02475792
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.02475792\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.02475792\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42671.02475792"
INFO:core.logs:The pair: BTCUSDT - 42671.02475792 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.37180752
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.37180752\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.37180752\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.37180752"
INFO:core.logs:The pair: ETHUSDT - 2287.37180752 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998712
INFO:core.logs:The pair: USDTTRCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998712
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998712"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998712
INFO:core.logs:The pair: USDTERCUSDT - 0.998712 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42671.52052553
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.52052553\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.52052553\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42671.52052553"
INFO:core.logs:The pair: BTCUSDT - 42671.52052553 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.67652743
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.67652743\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.67652743\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.67652743"
INFO:core.logs:The pair: ETHUSDT - 2287.67652743 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42672.05328004
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42672.05328004\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42672.05328004\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42672.05328004"
INFO:core.logs:The pair: BTCUSDT - 42672.05328004 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.80330075
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.80330075\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.80330075\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.80330075"
INFO:core.logs:The pair: ETHUSDT - 2287.80330075 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42672.19639030
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42672.19639030\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42672.19639030\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42672.19639030"
INFO:core.logs:The pair: BTCUSDT - 42672.1963903 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2287.98678717
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.98678717\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2287.98678717\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2287.98678717"
INFO:core.logs:The pair: ETHUSDT - 2287.98678717 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42671.45493372
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.45493372\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.45493372\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42671.45493372"
INFO:core.logs:The pair: BTCUSDT - 42671.45493372 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.07369794
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.07369794\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.07369794\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.07369794"
INFO:core.logs:The pair: ETHUSDT - 2288.07369794 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42671.07371072
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.07371072\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42671.07371072\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42671.07371072"
INFO:core.logs:The pair: BTCUSDT - 42671.07371072 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.12145913
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.12145913\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.12145913\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.12145913"
INFO:core.logs:The pair: ETHUSDT - 2288.12145913 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42670.58943389
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.58943389\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.58943389\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42670.58943389"
INFO:core.logs:The pair: BTCUSDT - 42670.58943389 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.15957796
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.15957796\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.15957796\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.15957796"
INFO:core.logs:The pair: ETHUSDT - 2288.15957796 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
ERROR:aiomultiprocess.core:aio process 41927 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fbdb3176f50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42670.17721452
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.17721452\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.17721452\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42670.17721452"
INFO:core.logs:The pair: BTCUSDT - 42670.17721452 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.17554719
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.17554719\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.17554719\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.17554719"
INFO:core.logs:The pair: ETHUSDT - 2288.17554719 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42670.34241369
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.34241369\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42670.34241369\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42670.34241369"
INFO:core.logs:The pair: BTCUSDT - 42670.34241369 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.24884862
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.24884862\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.24884862\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.24884862"
INFO:core.logs:The pair: ETHUSDT - 2288.24884862 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42675.88428361
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.88428361\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42675.88428361\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42675.88428361"
INFO:core.logs:The pair: BTCUSDT - 42675.88428361 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.43413418
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.43413418\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.43413418\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.43413418"
INFO:core.logs:The pair: ETHUSDT - 2288.43413418 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42685.58569660
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42685.58569660\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42685.58569660\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42685.58569660"
INFO:core.logs:The pair: BTCUSDT - 42685.5856966 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.63636703
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.63636703\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.63636703\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.63636703"
INFO:core.logs:The pair: ETHUSDT - 2288.63636703 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42694.83125414
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42694.83125414\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42694.83125414\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42694.83125414"
INFO:core.logs:The pair: BTCUSDT - 42694.83125414 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2288.98052538
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.98052538\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2288.98052538\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2288.98052538"
INFO:core.logs:The pair: ETHUSDT - 2288.98052538 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42709.96786947
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42709.96786947\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42709.96786947\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42709.96786947"
INFO:core.logs:The pair: BTCUSDT - 42709.96786947 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2289.72989393
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.72989393\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2289.72989393\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2289.72989393"
INFO:core.logs:The pair: ETHUSDT - 2289.72989393 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.83
INFO:core.logs:The pair: USDTTRCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42714.92153584
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42714.92153584\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42714.92153584\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42714.92153584"
INFO:core.logs:The pair: BTCUSDT - 42714.92153584 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.14949610
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.14949610\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.14949610\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.14949610"
INFO:core.logs:The pair: ETHUSDT - 2290.1494961 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.83
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.83"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.83
INFO:core.logs:The pair: USDTERCRUB - 90.83 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42720.89407447
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42720.89407447\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42720.89407447\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42720.89407447"
INFO:core.logs:The pair: BTCUSDT - 42720.89407447 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: ETHUSDT: 2290.31713053
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.31713053\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.31713053\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.31713053"
INFO:core.logs:The pair: ETHUSDT - 2290.31713053 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42049 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fca12753730>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42725.57836243
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.57836243\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42725.57836243\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42725.57836243"
INFO:core.logs:The pair: BTCUSDT - 42725.57836243 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.37017671
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.37017671\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.37017671\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.37017671"
INFO:core.logs:The pair: ETHUSDT - 2290.37017671 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.99819
INFO:core.logs:The pair: USDTTRCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.99819
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.99819"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.99819
INFO:core.logs:The pair: USDTERCUSDT - 0.99819 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 42633
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42633"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42633"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 42633
INFO:core.logs:The pair: BTCUSDT - 42633.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 42259 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc4f2b4f610>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42731.69733047
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42731.69733047\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42731.69733047\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42731.69733047"
INFO:core.logs:The pair: BTCUSDT - 42731.69733047 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.42049057
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.42049057\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.42049057\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.42049057"
INFO:core.logs:The pair: ETHUSDT - 2290.42049057 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42735.25132041
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42735.25132041\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42735.25132041\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42735.25132041"
INFO:core.logs:The pair: BTCUSDT - 42735.25132041 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.34565956
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.34565956\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.34565956\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.34565956"
INFO:core.logs:The pair: ETHUSDT - 2290.34565956 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42738.67531867
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42738.67531867\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42738.67531867\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42738.67531867"
INFO:core.logs:The pair: BTCUSDT - 42738.67531867 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.49813810
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.49813810\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.49813810\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.49813810"
INFO:core.logs:The pair: ETHUSDT - 2290.4981381 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42317 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb454deb610>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fb454df9120>, 20983.708868231)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fb454dea0e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42742.69261660
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42742.69261660\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42742.69261660\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42742.69261660"
INFO:core.logs:The pair: BTCUSDT - 42742.6926166 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.55443255
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.55443255\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.55443255\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.55443255"
INFO:core.logs:The pair: ETHUSDT - 2290.55443255 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42743.93205053
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42743.93205053\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42743.93205053\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42743.93205053"
INFO:core.logs:The pair: BTCUSDT - 42743.93205053 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42391 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f1d76252f50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCUSDT 42695
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42695"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42695"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 42695
INFO:core.logs:The pair: BTCUSDT - 42695.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=bitcoin&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: BTCRUB 3885221
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3885221"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3885221"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3885221
INFO:core.logs:The pair: BTCRUB - 3885221.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHUSDT 2288.7
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2288.7"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2288.7"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2288.7
INFO:core.logs:The pair: ETHUSDT - 2288.7 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=ethereum&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: ETHRUB 208244
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208244"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "208244"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 208244
INFO:core.logs:The pair: ETHRUB - 208244.0 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42430 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f5e3d57ac50>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42747.27470779
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42747.27470779\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42747.27470779\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42747.27470779"
INFO:core.logs:The pair: BTCUSDT - 42747.27470779 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.54360270
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.54360270\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.54360270\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.54360270"
INFO:core.logs:The pair: ETHUSDT - 2290.5436027 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42750.84664813
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42750.84664813\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42750.84664813\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42750.84664813"
INFO:core.logs:The pair: BTCUSDT - 42750.84664813 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.59283440
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.59283440\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.59283440\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.59283440"
INFO:core.logs:The pair: ETHUSDT - 2290.5928344 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42752.68206447
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.68206447\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.68206447\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42752.68206447"
INFO:core.logs:The pair: BTCUSDT - 42752.68206447 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.60070209
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.60070209\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.60070209\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.60070209"
INFO:core.logs:The pair: ETHUSDT - 2290.60070209 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
ERROR:aiomultiprocess.core:aio process 42469 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f2c6d76ac80>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f2c6d799540>, 21094.171007992)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f2c6d76b040>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42756.45869818
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42756.45869818\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42756.45869818\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42756.45869818"
INFO:core.logs:The pair: BTCUSDT - 42756.45869818 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.62333708
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.62333708\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.62333708\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.62333708"
INFO:core.logs:The pair: ETHUSDT - 2290.62333708 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.88
INFO:core.logs:The pair: USDTERCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42754.18535649
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42754.18535649\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42754.18535649\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42754.18535649"
INFO:core.logs:The pair: BTCUSDT - 42754.18535649 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.42690754
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.42690754\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.42690754\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.42690754"
INFO:core.logs:The pair: ETHUSDT - 2290.42690754 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42752.41870604
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.41870604\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42752.41870604\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42752.41870604"
INFO:core.logs:The pair: BTCUSDT - 42752.41870604 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.40293750
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.40293750\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.40293750\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.40293750"
INFO:core.logs:The pair: ETHUSDT - 2290.4029375 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCUSDT: 42751.32107809
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.32107809\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.32107809\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42751.32107809"
INFO:core.logs:The pair: BTCUSDT - 42751.32107809 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.23144017
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.23144017\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.23144017\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.23144017"
INFO:core.logs:The pair: ETHUSDT - 2290.23144017 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.88
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.88"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.88
INFO:core.logs:The pair: USDTTRCRUB - 90.88 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42751.52149491
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.52149491\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.52149491\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42751.52149491"
INFO:core.logs:The pair: BTCUSDT - 42751.52149491 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.10558341
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.10558341\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.10558341\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.10558341"
INFO:core.logs:The pair: ETHUSDT - 2290.10558341 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998774
INFO:core.logs:The pair: USDTERCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 42551 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f94661736d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f94657d6ce0>, 21197.084283786)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f94661721a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42751.13699891
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.13699891\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.13699891\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42751.13699891"
INFO:core.logs:The pair: BTCUSDT - 42751.13699891 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.04492914
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.04492914\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.04492914\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.04492914"
INFO:core.logs:The pair: ETHUSDT - 2290.04492914 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42641 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ff105f535e0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42750.94798421
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42750.94798421\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42750.94798421\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42750.94798421"
INFO:core.logs:The pair: BTCUSDT - 42750.94798421 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.01803667
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.01803667\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.01803667\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.01803667"
INFO:core.logs:The pair: ETHUSDT - 2290.01803667 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42751.82829926
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.82829926\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42751.82829926\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42751.82829926"
INFO:core.logs:The pair: BTCUSDT - 42751.82829926 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.09313477
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.09313477\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.09313477\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.09313477"
INFO:core.logs:The pair: ETHUSDT - 2290.09313477 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42755.77904376
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42755.77904376\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42755.77904376\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42755.77904376"
INFO:core.logs:The pair: BTCUSDT - 42755.77904376 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.29369417
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.29369417\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.29369417\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.29369417"
INFO:core.logs:The pair: ETHUSDT - 2290.29369417 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998774
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998774"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998774
INFO:core.logs:The pair: USDTTRCUSDT - 0.998774 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42761.06171479
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42761.06171479\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42761.06171479\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42761.06171479"
INFO:core.logs:The pair: BTCUSDT - 42761.06171479 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.37159962
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.37159962\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.37159962\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.37159962"
INFO:core.logs:The pair: ETHUSDT - 2290.37159962 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42762.89353888
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42762.89353888\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42762.89353888\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42762.89353888"
INFO:core.logs:The pair: BTCUSDT - 42762.89353888 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.39430461
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.39430461\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.39430461\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.39430461"
INFO:core.logs:The pair: ETHUSDT - 2290.39430461 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42764.39593946
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42764.39593946\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42764.39593946\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42764.39593946"
INFO:core.logs:The pair: BTCUSDT - 42764.39593946 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.39704526
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.39704526\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.39704526\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.39704526"
INFO:core.logs:The pair: ETHUSDT - 2290.39704526 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42766.28816513
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42766.28816513\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42766.28816513\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42766.28816513"
INFO:core.logs:The pair: BTCUSDT - 42766.28816513 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.41292053
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.41292053\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.41292053\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.41292053"
INFO:core.logs:The pair: ETHUSDT - 2290.41292053 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42768.88619206
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42768.88619206\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42768.88619206\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42768.88619206"
INFO:core.logs:The pair: BTCUSDT - 42768.88619206 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.41856704
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.41856704\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.41856704\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.41856704"
INFO:core.logs:The pair: ETHUSDT - 2290.41856704 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42769.40642786
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42769.40642786\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42769.40642786\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42769.40642786"
INFO:core.logs:The pair: BTCUSDT - 42769.40642786 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.67862271
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.67862271\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.67862271\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.67862271"
INFO:core.logs:The pair: ETHUSDT - 2290.67862271 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42770.47232757
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42770.47232757\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42770.47232757\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42770.47232757"
INFO:core.logs:The pair: BTCUSDT - 42770.47232757 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.75733271
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.75733271\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.75733271\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.75733271"
INFO:core.logs:The pair: ETHUSDT - 2290.75733271 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42772.43105614
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.43105614\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.43105614\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42772.43105614"
INFO:core.logs:The pair: BTCUSDT - 42772.43105614 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.83237016
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.83237016\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.83237016\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.83237016"
INFO:core.logs:The pair: ETHUSDT - 2290.83237016 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    print(f"\n\n{data}\n\n")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42772.47749427
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.47749427\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.47749427\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42772.47749427"
INFO:core.logs:The pair: BTCUSDT - 42772.47749427 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42681 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7ffa9d57ac80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42772.39970672
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.39970672\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.39970672\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42772.39970672"
INFO:core.logs:The pair: BTCUSDT - 42772.39970672 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.85511772
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.85511772\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.85511772\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.85511772"
INFO:core.logs:The pair: ETHUSDT - 2290.85511772 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42772.30227438
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.30227438\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42772.30227438\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42772.30227438"
INFO:core.logs:The pair: BTCUSDT - 42772.30227438 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.90047212
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.90047212\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.90047212\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.90047212"
INFO:core.logs:The pair: ETHUSDT - 2290.90047212 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42773.43917341
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42773.43917341\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42773.43917341\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42773.43917341"
INFO:core.logs:The pair: BTCUSDT - 42773.43917341 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2290.96374798
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.96374798\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2290.96374798\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2290.96374798"
INFO:core.logs:The pair: ETHUSDT - 2290.96374798 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42775.93117023
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.93117023\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.93117023\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42775.93117023"
INFO:core.logs:The pair: BTCUSDT - 42775.93117023 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.03523058
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.03523058\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.03523058\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.03523058"
INFO:core.logs:The pair: ETHUSDT - 2291.03523058 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999521
INFO:core.logs:The pair: USDTERCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42777.19939161
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42777.19939161\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42777.19939161\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42777.19939161"
INFO:core.logs:The pair: BTCUSDT - 42777.19939161 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.17451435
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.17451435\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.17451435\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.17451435"
INFO:core.logs:The pair: ETHUSDT - 2291.17451435 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 38, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42869 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f19e6973640>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f19e699cfa0>, 21522.049550503)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f19e6972110>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42775.84788512
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.84788512\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.84788512\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42775.84788512"
INFO:core.logs:The pair: BTCUSDT - 42775.84788512 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.25584792
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.25584792\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.25584792\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.25584792"
INFO:core.logs:The pair: ETHUSDT - 2291.25584792 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42776.06212816
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42776.06212816\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42776.06212816\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - "42776.06212816"
INFO:core.logs:The pair: BTCUSDT - 42776.06212816 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.33860161
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.33860161\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.33860161\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.33860161"
INFO:core.logs:The pair: ETHUSDT - 2291.33860161 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999521
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999521"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999521
INFO:core.logs:The pair: USDTTRCUSDT - 0.999521 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 42994 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6ab9f77700>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f6ab9fa5060>, 21564.032821642)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6ab9f761d0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42776.06369367
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42776.06369367\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42776.06369367\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42776.06369367"
INFO:core.logs:The pair: BTCUSDT - 42776.06369367 has been updated
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.37064858
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.37064858\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.37064858\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.37064858"
INFO:core.logs:The pair: ETHUSDT - 2291.37064858 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 42775.64450234
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.64450234\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.64450234\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42775.64450234"
INFO:core.logs:The pair: BTCUSDT - 42775.64450234 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.43162996
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.43162996\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.43162996\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.43162996"
INFO:core.logs:The pair: ETHUSDT - 2291.43162996 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999972
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999972"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999972"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999972
INFO:core.logs:The pair: USDTTRCUSDT - 0.999972 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.95
INFO:core.logs:The pair: USDTTRCRUB - 90.95 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999972
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999972"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999972"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999972
INFO:core.logs:The pair: USDTERCUSDT - 0.999972 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42775.62173461
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.62173461\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.62173461\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42775.62173461"
INFO:core.logs:The pair: BTCUSDT - 42775.62173461 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.44748132
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.44748132\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.44748132\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.44748132"
INFO:core.logs:The pair: ETHUSDT - 2291.44748132 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 42775.81637657
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.81637657\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "\\"42775.81637657\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - "42775.81637657"
INFO:core.logs:The pair: BTCUSDT - 42775.81637657 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "\\"3900027.00000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - "3900027.00000000"
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.52681208
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.52681208\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "\\"2291.52681208\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - "2291.52681208"
INFO:core.logs:The pair: ETHUSDT - 2291.52681208 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "\\"181477.60000000\\""}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - "181477.60000000"
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 43039 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7facc396f6d0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7facc39951e0>, 21626.291488326)]']
connector: <aiohttp.connector.TCPConnector object at 0x7facc396e1a0>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 42775.65959063
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42775.65959063"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "42775.65959063"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 42775.65959063
INFO:core.logs:The pair: BTCUSDT - 42775.65959063 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2291.61866345
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2291.61866345"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2291.61866345"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2291.61866345
INFO:core.logs:The pair: ETHUSDT - 2291.61866345 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 37, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.95
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.95"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.95
INFO:core.logs:The pair: USDTERCRUB - 90.95 has been updated
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 43101 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f3e38373580>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f3e383a0fa0>, 21647.701801468)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f3e38372050>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43020.23459019
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43020.23459019"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43020.23459019"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 43020.23459019
WARNING:core.logs:The pair: BTCUSDT - 43020.23459019 did not appear in the database!
ERROR:core.logs:(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('BTCUSDT',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 522, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 636, in prepare
    return await self._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 654, in _prepare
    stmt = await self._get_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/tasks/save_db.py", line 12, in save_to_db
    db_pair = await db.execute(select(Pairs).filter(Pairs.symbol == pair))
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 455, in execute
    result = await greenlet_spawn(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 200, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('BTCUSDT',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
WARNING:core.logs:The pair: BTCRUB - 3900027.0 did not appear in the database!
ERROR:core.logs:(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('BTCRUB',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 522, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 636, in prepare
    return await self._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 654, in _prepare
    stmt = await self._get_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/tasks/save_db.py", line 12, in save_to_db
    db_pair = await db.execute(select(Pairs).filter(Pairs.symbol == pair))
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 455, in execute
    result = await greenlet_spawn(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 200, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('BTCRUB',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:core.logs:Binance returned price: ETHUSDT: 2305.90970661
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.90970661"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.90970661"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2305.90970661
WARNING:core.logs:The pair: ETHUSDT - 2305.90970661 did not appear in the database!
ERROR:core.logs:(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('ETHUSDT',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 522, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 636, in prepare
    return await self._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 654, in _prepare
    stmt = await self._get_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/tasks/save_db.py", line 12, in save_to_db
    db_pair = await db.execute(select(Pairs).filter(Pairs.symbol == pair))
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 455, in execute
    result = await greenlet_spawn(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 200, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('ETHUSDT',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
WARNING:core.logs:The pair: ETHRUB - 181477.6 did not appear in the database!
ERROR:core.logs:(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('ETHRUB',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 522, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 636, in prepare
    return await self._prepare(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 654, in _prepare
    stmt = await self._get_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/tasks/save_db.py", line 12, in save_to_db
    db_pair = await db.execute(select(Pairs).filter(Pairs.symbol == pair))
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 455, in execute
    result = await greenlet_spawn(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 200, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 130, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 195, in greenlet_spawn
    value = await result
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 509, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "pairs" does not exist
[SQL: SELECT pairs.symbol, pairs.price 
FROM pairs 
WHERE pairs.symbol = $1::VARCHAR]
[parameters: ('ETHRUB',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 47513 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f6176773640>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f61767a1000>, 23576.404371321)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f6176772110>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43188.49901610
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43188.4990161"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43188.4990161"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 43188.4990161
INFO:core.logs:Added new pair: BTCUSDT - 43188.4990161
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:Added new pair: BTCRUB - 3900027.0
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: ETHUSDT: 2311.98393069
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.98393069"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2311.98393069"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2311.98393069
INFO:core.logs:Added new pair: ETHUSDT - 2311.98393069
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:Added new pair: ETHRUB - 181477.6
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.999078
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999078"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.999078"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.999078
INFO:core.logs:Added new pair: USDTTRCUSDT - 0.999078
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.62
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.62"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.62"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.62
INFO:core.logs:Added new pair: USDTTRCRUB - 90.62
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.999078
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999078"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.999078"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.999078
INFO:core.logs:Added new pair: USDTERCUSDT - 0.999078
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.74
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.74"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.74"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.74
INFO:core.logs:Added new pair: USDTERCRUB - 90.74
INFO:core.logs:db_updated
ERROR:aiomultiprocess.core:aio process 53649 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=8080, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fc71367a050>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fc713598dc0>, 26065.738708911)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fc713679b70>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43226.40472465
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43226.40472465"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43226.40472465"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43226.40472465
INFO:core.logs:Added new pair: BTCUSDT - 43226.40472465
INFO:core.logs:db_updated
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:Added new pair: BTCRUB - 3900027.0
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.68206745
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.68206745"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.68206745"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2306.68206745
INFO:core.logs:Added new pair: ETHUSDT - 2306.68206745
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:Added new pair: ETHRUB - 181477.6
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:Added new pair: USDTTRCUSDT - 1.0
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.54
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.54"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.54"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.54
INFO:core.logs:Added new pair: USDTTRCRUB - 90.54
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998604
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998604
INFO:core.logs:Added new pair: USDTERCUSDT - 0.998604
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:Added new pair: USDTERCRUB - 90.71
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 43225.78884107
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43225.78884107"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43225.78884107"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43225.78884107
INFO:core.logs:The pair: BTCUSDT - 43225.78884107 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.74331374
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.74331374"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.74331374"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2306.74331374
INFO:core.logs:The pair: ETHUSDT - 2306.74331374 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 0.998604
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 0.998604
INFO:core.logs:The pair: USDTTRCUSDT - 0.998604 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 0.998604
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "0.998604"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 0.998604
INFO:core.logs:The pair: USDTERCUSDT - 0.998604 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.54
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.54"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.54"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.54
INFO:core.logs:The pair: USDTERCRUB - 90.54 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 43225.01203550
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43225.0120355"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43225.0120355"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43225.0120355
INFO:core.logs:The pair: BTCUSDT - 43225.0120355 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.73183342
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.73183342"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.73183342"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2306.73183342
INFO:core.logs:The pair: ETHUSDT - 2306.73183342 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:The pair: USDTTRCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:The pair: USDTERCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 43215.96422647
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43215.96422647"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43215.96422647"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43215.96422647
INFO:core.logs:The pair: BTCUSDT - 43215.96422647 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.62653654
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.62653654"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.62653654"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2306.62653654
INFO:core.logs:The pair: ETHUSDT - 2306.62653654 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:The pair: USDTTRCRUB - 90.71 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:The pair: USDTERCUSDT - 1.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43211.48202679
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43211.48202679"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43211.48202679"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43211.48202679
INFO:core.logs:The pair: BTCUSDT - 43211.48202679 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2306.14483642
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.14483642"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2306.14483642"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2306.14483642
INFO:core.logs:The pair: ETHUSDT - 2306.14483642 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43206.56469055
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43206.56469055"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43206.56469055"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43206.56469055
INFO:core.logs:The pair: BTCUSDT - 43206.56469055 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2305.88780660
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.8878066"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.8878066"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2305.8878066
INFO:core.logs:The pair: ETHUSDT - 2305.8878066 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance returned price: BTCUSDT: 43201.32400476
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43201.32400476"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43201.32400476"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCUSDT - 43201.32400476
INFO:core.logs:The pair: BTCUSDT - 43201.32400476 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2305.74256297
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.74256297"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.74256297"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHUSDT - 2305.74256297
INFO:core.logs:The pair: ETHUSDT - 2305.74256297 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTTRCRUB: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCUSDT: 'NoneType' object is not subscriptable
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 429 187
CRITICAL:core.logs:Coingeko is not active too!!!
ERROR:core.logs:'tether'
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 19, in get_pair_info
    res = await client.get_avg_price(symbol=pair, requests_params={"timeout": 2})
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 8239, in get_avg_price
    return await self._get('avgPrice', data=params, version=self.PRIVATE_API_VERSION)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7953, in _get
    return await self._request_api('get', path, signed, version, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7916, in _request_api
    return await self._request(method, uri, signed, **kwargs)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7899, in _request
    return await self._handle_response(response)
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/binance/client.py", line 7907, in _handle_response
    raise BinanceAPIException(response, response.status, await response.text())
binance.exceptions.BinanceAPIException: APIError(code=-1121): Invalid symbol.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/nats_server/producer_binance/binance_api.py", line 40, in get_pair_info
    log.info(f"Coingeko returned price: {pair} {data[ids][vs_currencies]}")
KeyError: 'tether'
ERROR:nats_server.producer_binance.binance_api:Ошибка при обновлении цены для USDTERCRUB: 'NoneType' object is not subscriptable
ERROR:nats.aio.client:nats: encountered error
nats.errors.UnexpectedEOF: nats: unexpected EOF
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/client.py", line 1330, in _select_next_server
    await self._transport.connect(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/transport.py", line 121, in connect
    r, w = await asyncio.wait_for(
  File "/usr/local/lib/python3.10/asyncio/tasks.py", line 447, in wait_for
    return fut.result()
  File "/usr/local/lib/python3.10/asyncio/streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 1055, in create_connection
    raise exceptions[0]
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/local/lib/python3.10/asyncio/selector_events.py", line 502, in sock_connect
    return await fut
  File "/usr/local/lib/python3.10/asyncio/selector_events.py", line 537, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 4222)
ERROR:nats.aio.client:nats: encountered error
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/client.py", line 1330, in _select_next_server
    await self._transport.connect(
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/nats/aio/transport.py", line 121, in connect
    r, w = await asyncio.wait_for(
  File "/usr/local/lib/python3.10/asyncio/tasks.py", line 447, in wait_for
    return fut.result()
  File "/usr/local/lib/python3.10/asyncio/streams.py", line 47, in open_connection
    transport, _ = await loop.create_connection(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 1055, in create_connection
    raise exceptions[0]
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 1040, in create_connection
    sock = await self._connect_sock(
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 954, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/local/lib/python3.10/asyncio/selector_events.py", line 502, in sock_connect
    return await fut
  File "/usr/local/lib/python3.10/asyncio/selector_events.py", line 537, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 4222)
ERROR:aiomultiprocess.core:aio process 66048 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=5051, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f378b6825c0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7f378b5a4f40>, 28845.351131339)]']
connector: <aiohttp.connector.TCPConnector object at 0x7f378b682f80>
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
DEBUG:asyncio:Using selector: EpollSelector
INFO:core.logs:NATS, Subscribers, BinanceClient were starting
INFO:core.logs:Binance returned price: BTCUSDT: 43184.39837806
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43184.39837806"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43184.39837806"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 43184.39837806
INFO:core.logs:Added new pair: BTCUSDT - 43184.39837806
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:Added new pair: BTCRUB - 3900027.0
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2305.22570405
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.22570405"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2305.22570405"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2305.22570405
INFO:core.logs:Added new pair: ETHUSDT - 2305.22570405
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:Added new pair: ETHRUB - 181477.6
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCUSDT - 1.0
INFO:core.logs:Added new pair: USDTTRCUSDT - 1.0
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTTRCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTTRCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTTRCRUB - 90.71
INFO:core.logs:Added new pair: USDTTRCRUB - 90.71
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=usd HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCUSDT 1.0
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCUSDT", "price": "1.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCUSDT - 1.0
INFO:core.logs:Added new pair: USDTERCUSDT - 1.0
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
DEBUG:urllib3.connectionpool:https://api.coingecko.com:443 "GET /api/v3/simple/price?ids=tether&vs_currencies=rub HTTP/1.1" 200 None
INFO:core.logs:Coingeko returned price: USDTERCRUB 90.71
INFO:core.logs:successful saved in cache: exchanger - coingeko
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "USDTERCRUB", "price": "90.71"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: USDTERCRUB - 90.71
INFO:core.logs:Added new pair: USDTERCRUB - 90.71
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCUSDT: 43176.48275450
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43176.4827545"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCUSDT", "price": "43176.4827545"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCUSDT - 43176.4827545
INFO:core.logs:The pair: BTCUSDT - 43176.4827545 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: BTCRUB: 3900027.00000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "BTCRUB", "price": "3900027.0"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: BTCRUB - 3900027.0
INFO:core.logs:The pair: BTCRUB - 3900027.0 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHUSDT: 2304.46297842
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2304.46297842"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHUSDT", "price": "2304.46297842"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHUSDT - 2304.46297842
INFO:core.logs:The pair: ETHUSDT - 2304.46297842 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance returned price: ETHRUB: 181477.60000000
INFO:core.logs:successful saved in cache: exchanger - binance
INFO:core.logs:publisher_ok
INFO:core.logs:message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=2)
INFO:core.logs:Start saving to cache
INFO:core.logs:Message received: Msg(_client=<nats client v2.6.0>, subject='update_price', reply='', data=b'{"pair": "ETHRUB", "price": "181477.6"}', headers=None, _metadata=None, _ackd=False, _sid=1)
INFO:core.logs:Start saving to DB
INFO:core.logs:successful saved in cache: ETHRUB - 181477.6
INFO:core.logs:The pair: ETHRUB - 181477.6 has been updated
INFO:core.logs:db_updated
INFO:core.logs:Binance is not active
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.coingecko.com:443
ERROR:aiomultiprocess.core:aio process 66797 failed
Traceback (most recent call last):
  File "/home/eugene/Документы/test_b_w_g/venv/lib/python3.10/site-packages/aiomultiprocess/core.py", line 143, in run_async
    result: R = loop.run_until_complete(unit.target(*unit.args, **unit.kwargs))
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 641, in run_until_complete
    return future.result()
  File "/home/eugene/Документы/test_b_w_g/main.py", line 13, in run_uvicorn
    await uvicorn.run("main:app", host="127.0.0.1", port=5051, reload=True, workers=3)
TypeError: object NoneType can't be used in 'await' expression
ERROR:asyncio:Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fbb9bdee0b0>
ERROR:asyncio:Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x7fbb9bdfce20>, 28908.339181229)]']
connector: <aiohttp.connector.TCPConnector object at 0x7fbb9bdedbd0>
